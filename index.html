<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Min SuperMobil</title>
    <style>
        :root { --ios-blue: #007AFF; --ios-bg: #000; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #111; font-family: -apple-system, sans-serif; height: 100vh; overflow: hidden; display: flex; justify-content: center; }

        .phone {
            width: 100%; height: 100%; max-width: 414px;
            background: url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?w=500') center/cover;
            position: relative; overflow: hidden; display: flex; flex-direction: column;
        }

        /* Status Bar */
        .status-bar { height: 44px; padding: 0 25px; display: flex; justify-content: space-between; align-items: center; color: white; font-weight: 600; z-index: 1000; }

        /* Home Screen */
        .home-screen { flex-grow: 1; display: grid; grid-template-columns: repeat(4, 1fr); grid-auto-rows: 100px; gap: 20px; padding: 40px 20px; transition: 0.3s; }
        .app-icon { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .icon-box { width: 60px; height: 60px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 30px; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .app-label { color: white; font-size: 11px; font-weight: 500; }

        /* App Windows */
        .app-window {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; transform: translateY(100%); transition: 0.4s cubic-bezier(0.1, 0.7, 0.1, 1);
            z-index: 500; display: flex; flex-direction: column;
        }
        .app-window.active { transform: translateY(0); }
        .app-header { padding: 45px 20px 15px; background: #f9f9f9; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 18px; }

        /* Browser App */
        .browser-toolbar { padding: 10px; background: #eee; display: flex; gap: 5px; }
        .browser-toolbar input { flex-grow: 1; border-radius: 10px; border: 1px solid #ccc; padding: 8px; }

        /* Messages App */
        #msg-content { flex-grow: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .bubble { padding: 10px 15px; border-radius: 20px; max-width: 80%; font-size: 14px; }
        .bubble.me { background: var(--ios-blue); color: white; align-self: flex-end; }
        .bubble.friend { background: #e5e5ea; color: black; align-self: flex-start; }

        /* Camera & Gallery */
        #camera-feed { width: 100%; height: 100%; object-fit: cover; background: #000; }
        .shutter-btn { width: 70px; height: 70px; border: 5px solid white; border-radius: 50%; position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); }
        .gallery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; padding: 2px; overflow-y: auto; }
        .gallery-grid img { width: 100%; aspect-ratio: 1; object-fit: cover; }

        .home-btn { width: 130px; height: 5px; background: white; border-radius: 10px; position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); z-index: 2000; cursor: pointer; }
        .home-btn.dark { background: #ccc; }
    </style>
</head>
<body>

<div class="phone">
    <div class="status-bar"><div id="clock">12:00</div><div>üì∂ üîã</div></div>

    <div class="home-screen">
        <div class="app-icon" onclick="openApp('msg-app')">
            <div class="icon-box" style="background: #34C759;">üí¨</div>
            <span class="app-label">Meldinger</span>
        </div>
        <div class="app-icon" onclick="openApp('browser-app')">
            <div class="icon-box" style="background: #5856D6;">üåê</div>
            <span class="app-label">Browser</span>
        </div>
        <div class="app-icon" onclick="openApp('cam-app')">
            <div class="icon-box" style="background: #8E8E93;">üì∑</div>
            <span class="app-label">Kamera</span>
        </div>
        <div class="app-icon" onclick="openApp('gal-app')">
            <div class="icon-box" style="background: linear-gradient(#ffdd00, #ff9500);">üñºÔ∏è</div>
            <span class="app-label">Galleri</span>
        </div>
    </div>

    <div id="browser-app" class="app-window">
        <div class="app-header">Nettleser</div>
        <div class="browser-toolbar">
            <input type="text" id="url-bar" placeholder="S√∏k eller URL...">
            <button onclick="browse()" style="border:none; color:var(--ios-blue); background:none;">G√•</button>
        </div>
        <iframe id="frame" style="flex-grow:1; border:none;" src="about:blank"></iframe>
    </div>

    <div id="msg-app" class="app-window">
        <div class="app-header">Vennen min</div>
        <div id="msg-content"></div>
        <div style="padding:10px; border-top:1px solid #ddd; display:flex; gap:5px;">
            <input type="text" id="msg-input" style="flex-grow:1; border-radius:20px; border:1px solid #ddd; padding:10px;">
            <button onclick="sendMsg()" style="border:none; color:var(--ios-blue); background:none; font-weight:bold;">Send</button>
        </div>
    </div>

    <div id="cam-app" class="app-window" style="background:black;">
        <video id="camera-feed" autoplay playsinline></video>
        <div class="shutter-btn" onclick="takePhoto()"></div>
    </div>

    <div id="gal-app" class="app-window">
        <div class="app-header">Bilder</div>
        <div id="gallery-list" class="gallery-grid"></div>
    </div>

    <div class="home-btn" id="hb" onclick="goHome()"></div>
</div>

<script>
    // System logikk
    function updateClock() {
        const d = new Date();
        document.getElementById('clock').innerText = d.getHours() + ":" + d.getMinutes().toString().padStart(2, '0');
    }
    setInterval(updateClock, 1000); updateClock();

    function openApp(id) {
        document.getElementById(id).classList.add('active');
        document.getElementById('hb').classList.add('dark');
        if(id === 'cam-app') startCam();
        if(id === 'gal-app') loadGallery();
    }
    function goHome() {
        document.querySelectorAll('.app-window').forEach(a => a.classList.remove('active'));
        document.getElementById('hb').classList.remove('dark');
        stopCam();
    }

    // Chat logikk
    let chat = JSON.parse(localStorage.getItem('chat_db')) || [{t: "Hei! Har du sett den nye mobilen min?", s: "friend"}];
    function renderChat() {
        document.getElementById('msg-content').innerHTML = chat.map(m => `<div class="bubble ${m.s}">${m.t}</div>`).join('');
    }
    function sendMsg() {
        const i = document.getElementById('msg-input');
        if(!i.value) return;
        chat.push({t: i.value, s: "me"});
        setTimeout(() => { 
            chat.push({t: "Kult! Skal vi teste kameraet?", s: "friend"}); 
            renderChat(); 
            localStorage.setItem('chat_db', JSON.stringify(chat));
        }, 1000);
        i.value = ""; renderChat();
    }
    renderChat();

    // Kamera & Galleri logikk
    let stream;
    async function startCam() {
        stream = await navigator.mediaDevices.getUserMedia({video: {facingMode: "user"}});
        document.getElementById('camera-feed').srcObject = stream;
    }
    function stopCam() { if(stream) stream.getTracks().forEach(t => t.stop()); }

    function takePhoto() {
        const v = document.getElementById('camera-feed');
        const canvas = document.createElement('canvas');
        canvas.width = v.videoWidth; canvas.height = v.videoHeight;
        canvas.getContext('2d').drawImage(v, 0, 0);
        const data = canvas.toDataURL('image/png');
        let photos = JSON.parse(localStorage.getItem('photos')) || [];
        photos.unshift(data);
        localStorage.setItem('photos', JSON.stringify(photos));
        alert("Bilde lagret i Galleri!");
    }

    function loadGallery() {
        const photos = JSON.parse(localStorage.getItem('photos')) || [];
        document.getElementById('gallery-list').innerHTML = photos.map(p => `<img src="${p}">`).join('');
    }

    // Browser
    function browse() {
        const url = document.getElementById('url-bar').value;
        document.getElementById('frame').src = "https://www.google.com/search?q=" + encodeURIComponent(url) + "&igu=1";
    }
</script>
</body>
</html>

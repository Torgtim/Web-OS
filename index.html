<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SuperMobil v8</title>
    <style>
        :root { --ios-blue: #007AFF; --ios-red: #FF3B30; --ios-green: #34C759; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #1a1a1a; font-family: -apple-system, sans-serif; height: 100vh; display: flex; justify-content: center; align-items: center; }

        /* DYNAMISK RAMME */
        .phone-frame { 
            width: 95vw; height: 95vh; max-width: 400px; max-height: 800px; 
            background: #000; border-radius: 40px; border: 8px solid #333; 
            position: relative; overflow: hidden; display: flex; flex-direction: column;
        }

        .screen { 
            flex-grow: 1; position: relative; 
            background: url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?w=500') center/cover;
            transition: 0.5s; 
        }

        /* L√ÖSESKJERM */
        #lock-screen {
            position: absolute; inset: 0; background: rgba(0,0,0,0.8); 
            z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;
            backdrop-filter: blur(10px); transition: 0.5s;
        }

        /* APPER */
        .app-window { position: absolute; inset: 0; background: white; transform: translateY(100%); transition: 0.4s cubic-bezier(0.1, 0.7, 0.1, 1); z-index: 500; display: flex; flex-direction: column; }
        .app-window.active { transform: translateY(0); }
        .app-header { padding: 40px 20px 10px; background: #f9f9f9; border-bottom: 1px solid #ddd; font-weight: bold; display: flex; justify-content: space-between; }

        /* MUSIKK MOBIL-DESIGN */
        .music-card { padding: 20px; text-align: center; }
        .song-list { flex-grow: 1; overflow-y: auto; padding: 10px; }
        .song-row { display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #eee; align-items: center; }

        /* HJEMSKJERM GRID */
        .home-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 20px; }
        .icon { display: flex; flex-direction: column; align-items: center; font-size: 30px; }
        .icon div { width: 55px; height: 55px; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

        .home-bar { height: 50px; background: #000; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .home-circle { width: 40px; height: 40px; border: 2px solid #555; border-radius: 50%; }
        
        canvas { background: #000; width: 100%; touch-action: none; }
    </style>
</head>
<body onload="init()">

<div class="phone-frame">
    <div id="lock-screen">
        <h2>Tast kode</h2>
        <input type="password" id="pin" maxlength="4" style="font-size:30px; width:100px; text-align:center; border-radius:10px; border:none; margin-bottom:20px;">
        <button onclick="checkPin()" style="padding:10px 20px; border-radius:20px; border:none; background:var(--ios-blue); color:white;">L√•s opp</button>
        <p id="lock-msg" style="color:red;"></p>
    </div>

    <div class="screen" id="main">
        <div style="height:35px; padding:10px 20px; color:white; display:flex; justify-content:space-between; font-size:12px; z-index:100;">
            <span id="time">12:00</span><span>üì∂ üîã</span>
        </div>

        <div class="home-grid">
            <div class="icon" onclick="openApp('app-music')"><div style="background:#FF2D55;">üéµ</div><span style="color:white;font-size:10px;">Musikk</span></div>
            <div class="icon" onclick="openApp('app-snake')"><div style="background:#000;">üêç</div><span style="color:white;font-size:10px;">Snake</span></div>
            <div class="icon" onclick="openApp('app-web')"><div style="background:#007AFF;">üåê</div><span style="color:white;font-size:10px;">Safari</span></div>
            <div class="icon" onclick="openApp('app-set')"><div style="background:#8E8E93;">‚öôÔ∏è</div><span style="color:white;font-size:10px;">Settings</span></div>
        </div>

        <div id="app-music" class="app-window">
            <div class="app-header">Musikk <label>‚ûï<input type="file" hidden accept="audio/*" onchange="handleMusic(event)"></label></div>
            <div class="music-card">
                <div id="m-art" style="width:120px;height:120px;background:#eee;margin:0 auto;border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:50px;">üé∂</div>
                <h4 id="m-title">Ingen sang</h4>
                <div style="font-size:25px; display:flex; justify-content:center; gap:30px;">
                    <span onclick="skip(-1)">‚èÆ</span> <span id="play-btn" onclick="playPause()">‚ñ∂Ô∏è</span> <span onclick="skip(1)">‚è≠</span>
                </div>
            </div>
            <div id="song-list" class="song-list"></div>
        </div>

        <div id="app-web" class="app-window">
            <div class="app-header">Safari <span onclick="document.getElementById('frame').src='https://www.bing.com'">üè†</span></div>
            <input type="text" id="url" placeholder="S√∏k p√• Bing..." style="padding:10px; border:none; background:#eee; margin:5px; border-radius:10px;">
            <iframe id="frame" src="https://www.bing.com" style="flex-grow:1; border:none;"></iframe>
        </div>

        <div id="app-snake" class="app-window">
            <div class="app-header">Snake - Poeng: <span id="score">0</span></div>
            <canvas id="snake-canvas" width="300" height="300"></canvas>
            <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:10px; padding:20px;">
                <button onclick="changeDir('UP')" style="grid-column:2;">‚ñ≤</button>
                <button onclick="changeDir('LEFT')">‚óÄ</button> <button onclick="changeDir('DOWN')">‚ñº</button> <button onclick="changeDir('RIGHT')">‚ñ∂</button>
            </div>
            <button onclick="startSnake()" style="margin:10px;">Start nytt spill</button>
        </div>

        <div id="app-set" class="app-window">
            <div class="app-header">Innstillinger</div>
            <div style="padding:20px;">
                <h4>Velg Bakgrunn</h4>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div onclick="setWall('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?w=500')" style="height:80px; background:url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?w=200') center; border-radius:10px;"></div>
                    <div onclick="setWall('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=500')" style="height:80px; background:url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=200') center; border-radius:10px;"></div>
                </div>
            </div>
        </div>

    </div>
    <div class="home-bar" onclick="goHome()"><div class="home-circle"></div></div>
</div>

<audio id="audio"></audio>

<script>
    let songs = []; let curIdx = 0; const audio = document.getElementById('audio');
    
    function init() {
        setInterval(() => { const d = new Date(); document.getElementById('time').innerText = d.getHours() + ":" + d.getMinutes().toString().padStart(2,'0'); }, 1000);
        const w = localStorage.getItem('wall'); if(w) document.getElementById('main').style.backgroundImage = `url('${w}')`;
    }

    function checkPin() {
        if(document.getElementById('pin').value === "1234") { document.getElementById('lock-screen').style.transform = "translateY(-100%)"; }
        else { document.getElementById('lock-msg').innerText = "Feil kode!"; }
    }

    function openApp(id) { document.getElementById(id).classList.add('active'); if(id==='app-snake') startSnake(); }
    function goHome() { document.querySelectorAll('.app-window').forEach(a => a.classList.remove('active')); stopSnake(); }

    function setWall(u) { document.getElementById('main').style.backgroundImage = `url('${u}')`; localStorage.setItem('wall', u); }

    // --- MUSIKK LOGIKK ---
    function handleMusic(e) {
        const file = e.target.files[0];
        if(file) {
            const url = URL.createObjectURL(file);
            songs.push({ name: file.name, url: url });
            renderSongs();
        }
    }
    function renderSongs() {
        document.getElementById('song-list').innerHTML = songs.map((s,i) => `
            <div class="song-row">
                <span onclick="playSong(${i})">üéµ ${s.name.substring(0,20)}</span>
                <button onclick="songs.splice(${i},1);renderSongs()" style="border:none;background:none;">‚ùå</button>
            </div>`).join('');
    }
    function playSong(i) {
        curIdx = i; audio.src = songs[i].url; audio.play();
        document.getElementById('m-title').innerText = songs[i].name;
        document.getElementById('play-btn').innerText = "‚è∏";
    }
    function playPause() { if(audio.paused) { audio.play(); document.getElementById('play-btn').innerText = "‚è∏"; } else { audio.pause(); document.getElementById('play-btn').innerText = "‚ñ∂Ô∏è"; } }
    function skip(d) { let n = curIdx + d; if(n >= 0 && n < songs.length) playSong(n); }

    // --- SNAKE LOGIKK ---
    let canvas = document.getElementById('snake-canvas'); let ctx = canvas.getContext('2d');
    let snake, food, dir, game;
    function startSnake() {
        clearInterval(game); snake = [{x:10, y:10}]; dir = 'RIGHT'; 
        food = {x: Math.floor(Math.random()*14), y: Math.floor(Math.random()*14)};
        game = setInterval(draw, 150);
    }
    function stopSnake() { clearInterval(game); }
    function changeDir(d) { dir = d; }
    function draw() {
        ctx.fillStyle = "black"; ctx.fillRect(0,0,300,300);
        ctx.fillStyle = "red"; ctx.fillRect(food.x*20, food.y*20, 18, 18);
        ctx.fillStyle = "lime";
        snake.forEach(p => ctx.fillRect(p.x*20, p.y*20, 18, 18));
        let h = {...snake[0]};
        if(dir==='UP') h.y--; if(dir==='DOWN') h.y++; if(dir==='LEFT') h.x--; if(dir==='RIGHT') h.x++;
        if(h.x === food.x && h.y === food.y) { food = {x: Math.floor(Math.random()*14), y: Math.floor(Math.random()*14)}; document.getElementById('score').innerText = snake.length; } else { snake.pop(); }
        if(h.x<0 || h.x>14 || h.y<0 || h.y>14 || snake.some(p=>p.x===h.x && p.y===h.y)) return startSnake();
        snake.unshift(h);
    }

    // --- BROWSER ---
    document.getElementById('url').onkeypress = (e) => { if(e.key==='Enter') document.getElementById('frame').src = 'https://www.bing.com/search?q=' + e.target.value; };
</script>
</body>
</html>
